\hypertarget{namespacenum__recipes}{}\section{num\+\_\+recipes Module Reference}
\label{namespacenum__recipes}\index{num\+\_\+recipes@{num\+\_\+recipes}}


modern versions of numerical recipes routines  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \hyperlink{structnum__recipes_1_1context}{context}
\begin{DoxyCompactList}\small\item\em generic type for data in function callbacks \end{DoxyCompactList}\item 
interface \hyperlink{interfacenum__recipes_1_1func}{func}
\begin{DoxyCompactList}\small\item\em interface for function callbacks \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
integer function, public \hyperlink{namespacenum__recipes_a866cf4a4cf4693c7f6f56dd5ecbaf0c5}{kronecker\+\_\+delta} (i, j)
\item 
complex(dp) function, public \hyperlink{namespacenum__recipes_a024b1f51e277f9765e4ea2160090bc8c}{cmplx\+\_\+log\+\_\+gamma} (z)
\item 
complex(dp) function, public \hyperlink{namespacenum__recipes_ac4a87c3daeeb45285208250fd3f27d4a}{spherical\+\_\+harmonic} (l, m, theta, phi)
\item 
real(dp) function, public \hyperlink{namespacenum__recipes_abb39707356349ecadb66e01014f12520}{legendre\+\_\+poly} (l, m, x)
\begin{DoxyCompactList}\small\item\em Optimized function to calculate legendre polynomials. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacenum__recipes_a35e9f30262aeb7588bf205c2b018abd4}{dfridr} (f, data, x, h, df\+\_\+dx, err)
\begin{DoxyCompactList}\small\item\em numerical derivative of a function \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacenum__recipes_a1dfc128c6203c9e7bede17caa5fbb828}{sphbes} (n, x, sj, sy, sjp, syp)
\begin{DoxyCompactList}\small\item\em spherical Bessel functions \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacenum__recipes_ad8ad468d2545789939deec75dd273d93}{bessjy} (x, nu, rj, ry, rjp, ryp)
\begin{DoxyCompactList}\small\item\em Bessel functions of fractional order. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacenum__recipes_a361c889af1a90696af2e7b68b7ea8fd7}{beschb} (x, gam1, gam2, gampl, gammi)
\begin{DoxyCompactList}\small\item\em Chebyshev expansion for gamma terms in bessjy. \end{DoxyCompactList}\item 
real(dp) function \hyperlink{namespacenum__recipes_a798cfb76aca4655f8cc33fcfa19683d7}{chebev} (a, b, c, x)
\begin{DoxyCompactList}\small\item\em Chebyshev evaluation. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, parameter \hyperlink{namespacenum__recipes_a5e2fe25448fc2af7b6548e8a6aee6b98}{l\+\_\+max} = 2000
\item 
real(dp), dimension(0\+:\hyperlink{namespacenum__recipes_a5e2fe25448fc2af7b6548e8a6aee6b98}{l\+\_\+max}) \hyperlink{namespacenum__recipes_ac255de146726ccb211ee223424f8be21}{l\+\_\+array} = 0
\end{DoxyCompactItemize}


\subsection{Detailed Description}
modern versions of numerical recipes routines 

Collection of updated versions of subroutines and functions from the numerical recipes book

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez 
\end{DoxyAuthor}


\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacenum__recipes_a361c889af1a90696af2e7b68b7ea8fd7}\label{namespacenum__recipes_a361c889af1a90696af2e7b68b7ea8fd7}} 
\index{num\+\_\+recipes@{num\+\_\+recipes}!beschb@{beschb}}
\index{beschb@{beschb}!num\+\_\+recipes@{num\+\_\+recipes}}
\subsubsection{\texorpdfstring{beschb()}{beschb()}}
{\footnotesize\ttfamily subroutine num\+\_\+recipes\+::beschb (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{x,  }\item[{real(dp), intent(out)}]{gam1,  }\item[{real(dp), intent(out)}]{gam2,  }\item[{real(dp), intent(out)}]{gampl,  }\item[{real(dp), intent(out)}]{gammi }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Chebyshev expansion for gamma terms in bessjy. 

Modified from Numerical Recipes

Evaluates the $ \Gamma_1(x) $ and $ \Gamma_2(x) $ terms for the bessjy calculation by Chebyshev expansion for $ |x| \leq 1/2 $. Also returns $ 1/\Gamma(1 + x ) $ and $ 1/\Gamma(1 − x ) $.

$ \Gamma_1(x) = \frac{1}{2x} \left[\frac{1}{\Gamma(1-x)} - \frac{1}{\Gamma(1+x)} \right] $ (x) = \{1\}\{2\} \mbox{[}\{1\}\{(1-\/x)\} -\/ \{1\}\{(1+x)\} \mbox{]}

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & Point at which the $ \Gamma $ terms will be evaluated\\
\hline
\mbox{\tt out}  & {\em gam1} & $ \Gamma_1(x) $\\
\hline
\mbox{\tt out}  & {\em gam2} & $ \Gamma_2(x) $\\
\hline
\mbox{\tt out}  & {\em gampl} & $ 1/\Gamma_(1+x) $\\
\hline
\mbox{\tt out}  & {\em gammi} & $ 1/\Gamma_(1-x) $ \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacenum__recipes_ad8ad468d2545789939deec75dd273d93}\label{namespacenum__recipes_ad8ad468d2545789939deec75dd273d93}} 
\index{num\+\_\+recipes@{num\+\_\+recipes}!bessjy@{bessjy}}
\index{bessjy@{bessjy}!num\+\_\+recipes@{num\+\_\+recipes}}
\subsubsection{\texorpdfstring{bessjy()}{bessjy()}}
{\footnotesize\ttfamily subroutine, public num\+\_\+recipes\+::bessjy (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{x,  }\item[{real(dp), intent(in)}]{nu,  }\item[{real(dp), intent(out)}]{rj,  }\item[{real(dp), intent(out)}]{ry,  }\item[{real(dp), intent(out)}]{rjp,  }\item[{real(dp), intent(out)}]{ryp }\end{DoxyParamCaption})}



Bessel functions of fractional order. 

Modified from Numerical Recipes

Returns the Bessel functions $ J_\nu $ , $ Y_\nu $ and their derivatives $ J_\nu' $, $ Y_\nu' $ for positive x and for $ \nu \geq 0 $.

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & point at which the Bessel functions are evaluated\\
\hline
\mbox{\tt in}  & {\em nu} & Order of the Bessel functions\\
\hline
\mbox{\tt out}  & {\em rj} & regular spherical Bessel function $ J_\nu(x) $.\\
\hline
\mbox{\tt out}  & {\em ry} & irregular spherical Bessel function $ Y_\nu(x) $.\\
\hline
\mbox{\tt out}  & {\em rjp} & derivative of regular spherical Bessel function $ J_\nu'(x) $.\\
\hline
\mbox{\tt out}  & {\em ryp} & derivative of irregular spherical Bessel function $ Y_\nu'(x) $. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacenum__recipes_a798cfb76aca4655f8cc33fcfa19683d7}\label{namespacenum__recipes_a798cfb76aca4655f8cc33fcfa19683d7}} 
\index{num\+\_\+recipes@{num\+\_\+recipes}!chebev@{chebev}}
\index{chebev@{chebev}!num\+\_\+recipes@{num\+\_\+recipes}}
\subsubsection{\texorpdfstring{chebev()}{chebev()}}
{\footnotesize\ttfamily real(dp) function num\+\_\+recipes\+::chebev (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{a,  }\item[{real(dp), intent(in)}]{b,  }\item[{real(dp), dimension(\+:), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{x }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Chebyshev evaluation. 

Modified from Numerical Recipes

c(\+:) is an array of Chebyshev coefficients, usually the output from chebft (which must have been called with the same a and b ). The Chebyshev polynomial

$ \sum_{k=1}^m = c_k T_{k-1}(y) - c_1/2 $

is evaluated at a point $ y = [ x − ( b + a )/2]/[( b − a )/2] $.

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & interval lower limit\\
\hline
\mbox{\tt in}  & {\em b} & interval upper limit\\
\hline
\mbox{\tt in}  & {\em c} & Chebyshev coefficients\\
\hline
\mbox{\tt in}  & {\em x} & point where the polynomial es evaluated \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacenum__recipes_a024b1f51e277f9765e4ea2160090bc8c}\label{namespacenum__recipes_a024b1f51e277f9765e4ea2160090bc8c}} 
\index{num\+\_\+recipes@{num\+\_\+recipes}!cmplx\+\_\+log\+\_\+gamma@{cmplx\+\_\+log\+\_\+gamma}}
\index{cmplx\+\_\+log\+\_\+gamma@{cmplx\+\_\+log\+\_\+gamma}!num\+\_\+recipes@{num\+\_\+recipes}}
\subsubsection{\texorpdfstring{cmplx\+\_\+log\+\_\+gamma()}{cmplx\_log\_gamma()}}
{\footnotesize\ttfamily complex(dp) function, public num\+\_\+recipes\+::cmplx\+\_\+log\+\_\+gamma (\begin{DoxyParamCaption}\item[{complex(dp), intent(in)}]{z }\end{DoxyParamCaption})}

\mbox{\Hypertarget{namespacenum__recipes_a35e9f30262aeb7588bf205c2b018abd4}\label{namespacenum__recipes_a35e9f30262aeb7588bf205c2b018abd4}} 
\index{num\+\_\+recipes@{num\+\_\+recipes}!dfridr@{dfridr}}
\index{dfridr@{dfridr}!num\+\_\+recipes@{num\+\_\+recipes}}
\subsubsection{\texorpdfstring{dfridr()}{dfridr()}}
{\footnotesize\ttfamily subroutine, public num\+\_\+recipes\+::dfridr (\begin{DoxyParamCaption}\item[{procedure(\hyperlink{interfacenum__recipes_1_1func}{func})}]{f,  }\item[{type(\hyperlink{structnum__recipes_1_1context}{context}), intent(in)}]{data,  }\item[{real(dp), intent(in)}]{x,  }\item[{real(dp), intent(in)}]{h,  }\item[{real(dp), intent(out)}]{df\+\_\+dx,  }\item[{real(dp), intent(out)}]{err }\end{DoxyParamCaption})}



numerical derivative of a function 

Returns the derivative of a function f at a point x by Ridders’ method of polynomial extrapolation. The value h is input as an estimated initial step-\/size; it need not be small, but rather should be an increment in x over which f changes substantially. An estimate of the error in the derivative is returned as err.

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
 & {\em f} & function whose derivative will be calculated\\
\hline
\mbox{\tt in}  & {\em data} & context type containing the data necessary to evaluate f\\
\hline
\mbox{\tt in}  & {\em x} & point at which the derivative will be evaluated\\
\hline
\mbox{\tt in}  & {\em h} & estimated initial step-\/size. should be an increment in x over which f changes substantially\\
\hline
\mbox{\tt out}  & {\em df\+\_\+dx} & derivative of f at x\\
\hline
\mbox{\tt out}  & {\em err} & estimate of the error in the derivative \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacenum__recipes_a866cf4a4cf4693c7f6f56dd5ecbaf0c5}\label{namespacenum__recipes_a866cf4a4cf4693c7f6f56dd5ecbaf0c5}} 
\index{num\+\_\+recipes@{num\+\_\+recipes}!kronecker\+\_\+delta@{kronecker\+\_\+delta}}
\index{kronecker\+\_\+delta@{kronecker\+\_\+delta}!num\+\_\+recipes@{num\+\_\+recipes}}
\subsubsection{\texorpdfstring{kronecker\+\_\+delta()}{kronecker\_delta()}}
{\footnotesize\ttfamily integer function, public num\+\_\+recipes\+::kronecker\+\_\+delta (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{i,  }\item[{integer, intent(in)}]{j }\end{DoxyParamCaption})}

\mbox{\Hypertarget{namespacenum__recipes_abb39707356349ecadb66e01014f12520}\label{namespacenum__recipes_abb39707356349ecadb66e01014f12520}} 
\index{num\+\_\+recipes@{num\+\_\+recipes}!legendre\+\_\+poly@{legendre\+\_\+poly}}
\index{legendre\+\_\+poly@{legendre\+\_\+poly}!num\+\_\+recipes@{num\+\_\+recipes}}
\subsubsection{\texorpdfstring{legendre\+\_\+poly()}{legendre\_poly()}}
{\footnotesize\ttfamily real(dp) function, public num\+\_\+recipes\+::legendre\+\_\+poly (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{l,  }\item[{integer, intent(in)}]{m,  }\item[{real(dp), intent(in)}]{x }\end{DoxyParamCaption})}



Optimized function to calculate legendre polynomials. 

Modifies an algorithm to calculate legendre polynomials to save the previous values and build up from them. This eliminates the need to start from the beginning when using same x and m values

\begin{DoxyAuthor}{Author}
Raul L Bernal-\/\+Gonzalez 
\end{DoxyAuthor}
\mbox{\Hypertarget{namespacenum__recipes_a1dfc128c6203c9e7bede17caa5fbb828}\label{namespacenum__recipes_a1dfc128c6203c9e7bede17caa5fbb828}} 
\index{num\+\_\+recipes@{num\+\_\+recipes}!sphbes@{sphbes}}
\index{sphbes@{sphbes}!num\+\_\+recipes@{num\+\_\+recipes}}
\subsubsection{\texorpdfstring{sphbes()}{sphbes()}}
{\footnotesize\ttfamily subroutine, public num\+\_\+recipes\+::sphbes (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{n,  }\item[{real(dp), intent(in)}]{x,  }\item[{real(dp), intent(out)}]{sj,  }\item[{real(dp), intent(out)}]{sy,  }\item[{real(dp), intent(out)}]{sjp,  }\item[{real(dp), intent(out)}]{syp }\end{DoxyParamCaption})}



spherical Bessel functions 

Modified from Numerical Recipes

Calculates the spherical Bessel functions $ j_n(x) $, $ y_n(x) $, and their derivatives $ j_n'(x) $, $ y_n'(x) $ for an integer \$f n


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em n} & order of the spherical Bessel functions.\\
\hline
\mbox{\tt in}  & {\em x} & point at which the Bessel functions are evaluated.\\
\hline
\mbox{\tt out}  & {\em sj} & regular spherical Bessel function $ j_n(x) $.\\
\hline
\mbox{\tt out}  & {\em sy} & irregular spherical Bessel function $ y_n(x) $.\\
\hline
\mbox{\tt out}  & {\em sjp} & derivative of the regular spherical Bessel function $ j_n'(x) $.\\
\hline
\mbox{\tt out}  & {\em syp} & derivative of the irregular spherical Bessel function $ y_n'(x) $. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacenum__recipes_ac4a87c3daeeb45285208250fd3f27d4a}\label{namespacenum__recipes_ac4a87c3daeeb45285208250fd3f27d4a}} 
\index{num\+\_\+recipes@{num\+\_\+recipes}!spherical\+\_\+harmonic@{spherical\+\_\+harmonic}}
\index{spherical\+\_\+harmonic@{spherical\+\_\+harmonic}!num\+\_\+recipes@{num\+\_\+recipes}}
\subsubsection{\texorpdfstring{spherical\+\_\+harmonic()}{spherical\_harmonic()}}
{\footnotesize\ttfamily complex(dp) function, public num\+\_\+recipes\+::spherical\+\_\+harmonic (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{l,  }\item[{integer, intent(in)}]{m,  }\item[{real(dp), intent(in)}]{theta,  }\item[{real(dp), intent(in)}]{phi }\end{DoxyParamCaption})}



\subsection{Variable Documentation}
\mbox{\Hypertarget{namespacenum__recipes_ac255de146726ccb211ee223424f8be21}\label{namespacenum__recipes_ac255de146726ccb211ee223424f8be21}} 
\index{num\+\_\+recipes@{num\+\_\+recipes}!l\+\_\+array@{l\+\_\+array}}
\index{l\+\_\+array@{l\+\_\+array}!num\+\_\+recipes@{num\+\_\+recipes}}
\subsubsection{\texorpdfstring{l\+\_\+array}{l\_array}}
{\footnotesize\ttfamily real(dp), dimension(0\+:\hyperlink{namespacenum__recipes_a5e2fe25448fc2af7b6548e8a6aee6b98}{l\+\_\+max}) num\+\_\+recipes\+::l\+\_\+array = 0\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{namespacenum__recipes_a5e2fe25448fc2af7b6548e8a6aee6b98}\label{namespacenum__recipes_a5e2fe25448fc2af7b6548e8a6aee6b98}} 
\index{num\+\_\+recipes@{num\+\_\+recipes}!l\+\_\+max@{l\+\_\+max}}
\index{l\+\_\+max@{l\+\_\+max}!num\+\_\+recipes@{num\+\_\+recipes}}
\subsubsection{\texorpdfstring{l\+\_\+max}{l\_max}}
{\footnotesize\ttfamily integer, parameter num\+\_\+recipes\+::l\+\_\+max = 2000\hspace{0.3cm}{\ttfamily [private]}}

