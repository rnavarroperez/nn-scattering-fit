\hypertarget{namespacenn__phaseshifts}{}\section{nn\+\_\+phaseshifts Module Reference}
\label{namespacenn__phaseshifts}\index{nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}}
\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \hyperlink{interfacenn__phaseshifts_1_1nn__potential}{nn\+\_\+potential}
\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public \hyperlink{namespacenn__phaseshifts_aaeeb14cbe1324015fe5d7bff37607bb0}{all\+\_\+phaseshifts} (model, params, t\+\_\+lab, reaction, r\+\_\+max, dr, k\+\_\+cm, phases, d\+\_\+phases)
\begin{DoxyCompactList}\small\item\em phaseshifts for all partial waves \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacenn__phaseshifts_a64b8d559b174ac865dfde5b7d067b5aa}{coupled\+\_\+variable\+\_\+phase} (j, k, r, lambdas, d\+\_\+lambdas, a, b, c, d, d\+\_\+a, d\+\_\+b, d\+\_\+c, d\+\_\+d)
\begin{DoxyCompactList}\small\item\em variable phase equation integration in coupled channels \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacenn__phaseshifts_a3af2de3d09433aeda72d9bf4f252ac9e}{uncoupled\+\_\+variable\+\_\+phase} (l, k, r, lambda, d\+\_\+lambda, tan\+\_\+delta, d\+\_\+tan\+\_\+delta)
\begin{DoxyCompactList}\small\item\em variable phase equation for uncoupled waves \end{DoxyCompactList}\item 
real(dp) function, public \hyperlink{namespacenn__phaseshifts_a1d2c18032125ef6b75cc0170eb7c7cca}{momentum\+\_\+cm} (t\+\_\+lab, reaction)
\begin{DoxyCompactList}\small\item\em center of mass momentum \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacenn__phaseshifts_afbf7c7b1957246b291a52e9b125ef04e}{solve\+\_\+alfas} (a1, b1, c1, d1, a2, b2, c2, d2, d\+\_\+a1, d\+\_\+b1, d\+\_\+c1, d\+\_\+d1, d\+\_\+a2, d\+\_\+b2, d\+\_\+c2, d\+\_\+d2, alfa\+\_\+1, alfa\+\_\+2, d\+\_\+alfa\+\_\+1, d\+\_\+alfa\+\_\+2)
\begin{DoxyCompactList}\small\item\em find alfa parameters in coupled channels \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacenn__phaseshifts_aaf6bc866ac6041ef0c637dab1102128d}{eigen\+\_\+phases} (a1, b1, c1, d1, a2, b2, c2, d2, d\+\_\+a1, d\+\_\+b1, d\+\_\+c1, d\+\_\+d1, d\+\_\+a2, d\+\_\+b2, d\+\_\+c2, d\+\_\+d2, alfa\+\_\+1, alfa\+\_\+2, d\+\_\+alfa\+\_\+1, d\+\_\+alfa\+\_\+2, ps\+\_\+eigen, d\+\_\+ps\+\_\+eigen)
\begin{DoxyCompactList}\small\item\em Eigen phaseshifts for coupled channel. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacenn__phaseshifts_a15db9c0b3bd3b67547327fb5935a8e08}{eigen\+\_\+2\+\_\+bar} (ps\+\_\+eigen, d\+\_\+ps\+\_\+eigen, ps\+\_\+bar, d\+\_\+ps\+\_\+bar)
\begin{DoxyCompactList}\small\item\em eigen to nuclear bar conversion \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacenn__phaseshifts_a1604cc5651f2d6761cb82b494ec40e23}{match\+\_\+uncoupled\+\_\+waves} (s, k, r, lambdas, d\+\_\+lambdas, tan\+\_\+deltas, d\+\_\+tan\+\_\+deltas)
\begin{DoxyCompactList}\small\item\em Matches the uncoupled asymptotic solution the Coulomb wave function. \end{DoxyCompactList}\item 
real(dp) function, public \hyperlink{namespacenn__phaseshifts_af570a5386b15b626b75fe46125ae0abe}{eta\+\_\+prime} (k)
\item 
subroutine \hyperlink{namespacenn__phaseshifts_a06ad5d92bcc80ec0ffd8320854595af6}{match\+\_\+coupled\+\_\+waves} (k, r, lambdas, d\+\_\+lambdas, a, b, c, d, d\+\_\+a, d\+\_\+b, d\+\_\+c, d\+\_\+d)
\begin{DoxyCompactList}\small\item\em Matches the coupled asymptotic solution to the Coulomb wave function. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacenn__phaseshifts_a4cd6862b1d9183019dfabf2b8a2f1e98}{add\+\_\+coulomb} (r, k, v\+\_\+pw)
\begin{DoxyCompactList}\small\item\em Adds energy dependent Coulomb term to pp potential. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacenn__phaseshifts_a4cd6862b1d9183019dfabf2b8a2f1e98}\label{namespacenn__phaseshifts_a4cd6862b1d9183019dfabf2b8a2f1e98}} 
\index{nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}!add\+\_\+coulomb@{add\+\_\+coulomb}}
\index{add\+\_\+coulomb@{add\+\_\+coulomb}!nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}}
\subsubsection{\texorpdfstring{add\+\_\+coulomb()}{add\_coulomb()}}
{\footnotesize\ttfamily subroutine nn\+\_\+phaseshifts\+::add\+\_\+coulomb (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{r,  }\item[{real(dp), intent(in)}]{k,  }\item[{real(dp), dimension(\+:, \+:), intent(out)}]{v\+\_\+pw }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Adds energy dependent Coulomb term to pp potential. 

Adds an energy dependent Coulomb term to the pp potential in all partial waves

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em r} & potential radius in fm\\
\hline
\mbox{\tt in}  & {\em k} & center of mass momentum in fm $^{-1}$\\
\hline
\mbox{\tt out}  & {\em v\+\_\+pw} & pp potential for all partial waves in MeV \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacenn__phaseshifts_aaeeb14cbe1324015fe5d7bff37607bb0}\label{namespacenn__phaseshifts_aaeeb14cbe1324015fe5d7bff37607bb0}} 
\index{nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}!all\+\_\+phaseshifts@{all\+\_\+phaseshifts}}
\index{all\+\_\+phaseshifts@{all\+\_\+phaseshifts}!nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}}
\subsubsection{\texorpdfstring{all\+\_\+phaseshifts()}{all\_phaseshifts()}}
{\footnotesize\ttfamily subroutine, public nn\+\_\+phaseshifts\+::all\+\_\+phaseshifts (\begin{DoxyParamCaption}\item[{procedure(\hyperlink{interfacenn__phaseshifts_1_1nn__potential}{nn\+\_\+potential})}]{model,  }\item[{real(dp), dimension(\+:), intent(in)}]{params,  }\item[{real(dp), intent(in)}]{t\+\_\+lab,  }\item[{character(len=2), intent(in)}]{reaction,  }\item[{real(dp), intent(in)}]{r\+\_\+max,  }\item[{real(dp), intent(in)}]{dr,  }\item[{real(dp), intent(out)}]{k\+\_\+cm,  }\item[{real(dp), dimension(\+:, \+:), intent(out)}]{phases,  }\item[{real(dp), dimension(\+:, \+:, \+:), intent(out), allocatable}]{d\+\_\+phases }\end{DoxyParamCaption})}



phaseshifts for all partial waves 

given a model for a local NN potential with its corresponding phenomenological parameters, uses the variable phase equation to integrate the reduced Schr√∂dinger equation and calculates the phaseshifts (i.\+e. S-\/matrix) at all partial waves up to a maximum total angular momentum

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
 & {\em model} & local NN potential (subroutine)\\
\hline
\mbox{\tt in}  & {\em params} & phenomenological parameters for the local potential\\
\hline
\mbox{\tt in}  & {\em t\+\_\+lab} & laboratory energy of the scattering in MeV\\
\hline
\mbox{\tt in}  & {\em reaction} & reaction channel (pp, np or nn)\\
\hline
\mbox{\tt in}  & {\em r\+\_\+max} & maximum radius of integration\\
\hline
\mbox{\tt in}  & {\em dr} & integration step\\
\hline
\mbox{\tt out}  & {\em k\+\_\+cm} & exchange momentum in center of mass frame. In units of fm $^{-1}$\\
\hline
\mbox{\tt out}  & {\em phases} & phaseshifts in all partial waves\\
\hline
\mbox{\tt out}  & {\em d\+\_\+phases} & derivatives of the partial waves with respect to the potential parameters \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacenn__phaseshifts_a64b8d559b174ac865dfde5b7d067b5aa}\label{namespacenn__phaseshifts_a64b8d559b174ac865dfde5b7d067b5aa}} 
\index{nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}!coupled\+\_\+variable\+\_\+phase@{coupled\+\_\+variable\+\_\+phase}}
\index{coupled\+\_\+variable\+\_\+phase@{coupled\+\_\+variable\+\_\+phase}!nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}}
\subsubsection{\texorpdfstring{coupled\+\_\+variable\+\_\+phase()}{coupled\_variable\_phase()}}
{\footnotesize\ttfamily subroutine nn\+\_\+phaseshifts\+::coupled\+\_\+variable\+\_\+phase (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{j,  }\item[{real(dp), intent(in)}]{k,  }\item[{real(dp), intent(in)}]{r,  }\item[{real(dp), dimension(1\+:3), intent(in)}]{lambdas,  }\item[{real(dp), dimension(\+:, \+:), intent(in)}]{d\+\_\+lambdas,  }\item[{real(dp), intent(inout)}]{a,  }\item[{real(dp), intent(inout)}]{b,  }\item[{real(dp), intent(inout)}]{c,  }\item[{real(dp), intent(inout)}]{d,  }\item[{real(dp), dimension(\+:), intent(inout)}]{d\+\_\+a,  }\item[{real(dp), dimension(\+:), intent(inout)}]{d\+\_\+b,  }\item[{real(dp), dimension(\+:), intent(inout)}]{d\+\_\+c,  }\item[{real(dp), dimension(\+:), intent(inout)}]{d\+\_\+d }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



variable phase equation integration in coupled channels 

Performs a single step in the integration of the variable phase equation for coupled channels with a total angular momentum j

See equation B27 in Phys. Rev. C 88 (2013) 064002

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em j} & total angular momentum quantum number\\
\hline
\mbox{\tt in}  & {\em k} & center of mass momentum in fm $^{-1}$\\
\hline
\mbox{\tt in}  & {\em r} & integration radius in fm\\
\hline
\mbox{\tt in}  & {\em lambdas} & lambda strength coefficients in fm $^{-2}$\\
\hline
\mbox{\tt in}  & {\em d\+\_\+lambdas} & derivatives of the lambda strength coefficients\\
\hline
\mbox{\tt in,out}  & {\em a} & $A$ parameter\\
\hline
\mbox{\tt in,out}  & {\em b} & $B$ parameter\\
\hline
\mbox{\tt in,out}  & {\em c} & $C$ parameter\\
\hline
\mbox{\tt in,out}  & {\em d} & $D$ parameter\\
\hline
\mbox{\tt in,out}  & {\em d\+\_\+a} & derivatives of the $A$ parameter\\
\hline
\mbox{\tt in,out}  & {\em d\+\_\+b} & derivatives of the $B$ parameter\\
\hline
\mbox{\tt in,out}  & {\em d\+\_\+c} & derivatives of the $C$ parameter\\
\hline
\mbox{\tt in,out}  & {\em d\+\_\+d} & derivatives of the $D$ parameter \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacenn__phaseshifts_a15db9c0b3bd3b67547327fb5935a8e08}\label{namespacenn__phaseshifts_a15db9c0b3bd3b67547327fb5935a8e08}} 
\index{nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}!eigen\+\_\+2\+\_\+bar@{eigen\+\_\+2\+\_\+bar}}
\index{eigen\+\_\+2\+\_\+bar@{eigen\+\_\+2\+\_\+bar}!nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}}
\subsubsection{\texorpdfstring{eigen\+\_\+2\+\_\+bar()}{eigen\_2\_bar()}}
{\footnotesize\ttfamily subroutine nn\+\_\+phaseshifts\+::eigen\+\_\+2\+\_\+bar (\begin{DoxyParamCaption}\item[{real(dp), dimension(1\+:3), intent(in)}]{ps\+\_\+eigen,  }\item[{real(dp), dimension(\+:, \+:), intent(in)}]{d\+\_\+ps\+\_\+eigen,  }\item[{real(dp), dimension(1\+:3), intent(out)}]{ps\+\_\+bar,  }\item[{real(dp), dimension(\+:, \+:), intent(out)}]{d\+\_\+ps\+\_\+bar }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



eigen to nuclear bar conversion 

Converts the set of phaseshifts in a coupled channel from the eigen to the nuclear bar parametrization

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ps\+\_\+eigen} & eigen phaseshifts in a coupled channel\\
\hline
\mbox{\tt in}  & {\em d\+\_\+ps\+\_\+eigen} & derivatives of the eigen phaseshifts in a coupled channel\\
\hline
\mbox{\tt out}  & {\em ps\+\_\+bar} & nuclear bar phaseshifts in a coupled channel\\
\hline
\mbox{\tt out}  & {\em d\+\_\+ps\+\_\+bar} & derivatives of the nuclear bar phaseshifts in a coupled channel \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacenn__phaseshifts_aaf6bc866ac6041ef0c637dab1102128d}\label{namespacenn__phaseshifts_aaf6bc866ac6041ef0c637dab1102128d}} 
\index{nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}!eigen\+\_\+phases@{eigen\+\_\+phases}}
\index{eigen\+\_\+phases@{eigen\+\_\+phases}!nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}}
\subsubsection{\texorpdfstring{eigen\+\_\+phases()}{eigen\_phases()}}
{\footnotesize\ttfamily subroutine nn\+\_\+phaseshifts\+::eigen\+\_\+phases (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{a1,  }\item[{real(dp), intent(in)}]{b1,  }\item[{real(dp), intent(in)}]{c1,  }\item[{real(dp), intent(in)}]{d1,  }\item[{real(dp), intent(in)}]{a2,  }\item[{real(dp), intent(in)}]{b2,  }\item[{real(dp), intent(in)}]{c2,  }\item[{real(dp), intent(in)}]{d2,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+a1,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+b1,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+c1,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+d1,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+a2,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+b2,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+c2,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+d2,  }\item[{real(dp), intent(in)}]{alfa\+\_\+1,  }\item[{real(dp), intent(in)}]{alfa\+\_\+2,  }\item[{real(dp), dimension(\+:), intent(out)}]{d\+\_\+alfa\+\_\+1,  }\item[{real(dp), dimension(\+:), intent(out)}]{d\+\_\+alfa\+\_\+2,  }\item[{real(dp), dimension(1\+:3), intent(out)}]{ps\+\_\+eigen,  }\item[{real(dp), dimension(\+:, \+:), intent(out)}]{d\+\_\+ps\+\_\+eigen }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Eigen phaseshifts for coupled channel. 

Calculates the Eigen phaseshifts of a coupled partial waves channel after the variable phases equation has been integrated.

See equation B25 in Phys. Rev. C 88 (2013) 064002

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a1} & the $A_1$ parameter\\
\hline
\mbox{\tt in}  & {\em b1} & the $B_1$ parameter\\
\hline
\mbox{\tt in}  & {\em c1} & the $C_1$ parameter\\
\hline
\mbox{\tt in}  & {\em d1} & the $D_1$ parameter\\
\hline
\mbox{\tt in}  & {\em a2} & the $A_2$ parameter\\
\hline
\mbox{\tt in}  & {\em b2} & the $B_2$ parameter\\
\hline
\mbox{\tt in}  & {\em c2} & the $C_2$ parameter\\
\hline
\mbox{\tt in}  & {\em d2} & the $D_2$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+a1} & derivatives of the $A_1$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+b1} & derivatives of the $B_1$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+c1} & derivatives of the $C_1$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+d1} & derivatives of the $D_1$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+a2} & derivatives of the $A_2$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+b2} & derivatives of the $B_2$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+c2} & derivatives of the $C_2$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+d2} & derivatives of the $D_2$ parameter\\
\hline
\mbox{\tt in}  & {\em alfa\+\_\+1} & the $\alpha_1$ solution\\
\hline
\mbox{\tt in}  & {\em alfa\+\_\+2} & the $\alpha_2$ solution\\
\hline
\mbox{\tt out}  & {\em d\+\_\+alfa\+\_\+1} & derivatives of the $\alpha_1$ solution\\
\hline
\mbox{\tt out}  & {\em d\+\_\+alfa\+\_\+2} & derivatives of the $\alpha_2$ solution\\
\hline
\mbox{\tt out}  & {\em ps\+\_\+eigen} & eigen phaseshifts in a coupled channel\\
\hline
\mbox{\tt out}  & {\em d\+\_\+ps\+\_\+eigen} & derivatives of the eigen phaseshifts in a coupled channel \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacenn__phaseshifts_af570a5386b15b626b75fe46125ae0abe}\label{namespacenn__phaseshifts_af570a5386b15b626b75fe46125ae0abe}} 
\index{nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}!eta\+\_\+prime@{eta\+\_\+prime}}
\index{eta\+\_\+prime@{eta\+\_\+prime}!nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}}
\subsubsection{\texorpdfstring{eta\+\_\+prime()}{eta\_prime()}}
{\footnotesize\ttfamily real(dp) function, public nn\+\_\+phaseshifts\+::eta\+\_\+prime (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{k }\end{DoxyParamCaption})}

\mbox{\Hypertarget{namespacenn__phaseshifts_a06ad5d92bcc80ec0ffd8320854595af6}\label{namespacenn__phaseshifts_a06ad5d92bcc80ec0ffd8320854595af6}} 
\index{nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}!match\+\_\+coupled\+\_\+waves@{match\+\_\+coupled\+\_\+waves}}
\index{match\+\_\+coupled\+\_\+waves@{match\+\_\+coupled\+\_\+waves}!nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}}
\subsubsection{\texorpdfstring{match\+\_\+coupled\+\_\+waves()}{match\_coupled\_waves()}}
{\footnotesize\ttfamily subroutine nn\+\_\+phaseshifts\+::match\+\_\+coupled\+\_\+waves (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{k,  }\item[{real(dp), intent(in)}]{r,  }\item[{real(dp), dimension(\+:, \+:), intent(in)}]{lambdas,  }\item[{real(dp), dimension(\+:, \+:, \+:), intent(in)}]{d\+\_\+lambdas,  }\item[{real(dp), dimension(\+:), intent(inout)}]{a,  }\item[{real(dp), dimension(\+:), intent(inout)}]{b,  }\item[{real(dp), dimension(\+:), intent(inout)}]{c,  }\item[{real(dp), dimension(\+:), intent(inout)}]{d,  }\item[{real(dp), dimension(\+:, \+:), intent(inout)}]{d\+\_\+a,  }\item[{real(dp), dimension(\+:, \+:), intent(inout)}]{d\+\_\+b,  }\item[{real(dp), dimension(\+:, \+:), intent(inout)}]{d\+\_\+c,  }\item[{real(dp), dimension(\+:, \+:), intent(inout)}]{d\+\_\+d }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Matches the coupled asymptotic solution to the Coulomb wave function. 

When integrating the coupled variable phase equation in the pp channel, the wave function in the last integration step is matched form the free particle wave functions (reduced spherical Bessel functions) to the Coulomb wave functions.

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em k} & center of mass momentum (in units of fm $^{-1}$)\\
\hline
\mbox{\tt in}  & {\em r} & integration radius in fm\\
\hline
\mbox{\tt in}  & {\em lambdas} & lambda strength coefficients for all coupled waves in fm $^{-2}$\\
\hline
\mbox{\tt in}  & {\em d\+\_\+lambdas} & derivatives lambda strength coefficients for all coupled waves\\
\hline
\mbox{\tt in,out}  & {\em a} & the $A$ parameter for all coupled waves\\
\hline
\mbox{\tt in,out}  & {\em b} & the $B$ parameter for all coupled waves\\
\hline
\mbox{\tt in,out}  & {\em c} & the $C$ parameter for all coupled waves\\
\hline
\mbox{\tt in,out}  & {\em d} & the $D$ parameter for all coupled waves\\
\hline
\mbox{\tt in,out}  & {\em d\+\_\+a} & derivatives of the $A$ parameter for all coupled waves\\
\hline
\mbox{\tt in,out}  & {\em d\+\_\+b} & derivatives of the $B$ parameter for all coupled waves\\
\hline
\mbox{\tt in,out}  & {\em d\+\_\+c} & derivatives of the $C$ parameter for all coupled waves\\
\hline
\mbox{\tt in,out}  & {\em d\+\_\+d} & derivatives of the $D$ parameter for all coupled waves \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacenn__phaseshifts_a1604cc5651f2d6761cb82b494ec40e23}\label{namespacenn__phaseshifts_a1604cc5651f2d6761cb82b494ec40e23}} 
\index{nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}!match\+\_\+uncoupled\+\_\+waves@{match\+\_\+uncoupled\+\_\+waves}}
\index{match\+\_\+uncoupled\+\_\+waves@{match\+\_\+uncoupled\+\_\+waves}!nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}}
\subsubsection{\texorpdfstring{match\+\_\+uncoupled\+\_\+waves()}{match\_uncoupled\_waves()}}
{\footnotesize\ttfamily subroutine nn\+\_\+phaseshifts\+::match\+\_\+uncoupled\+\_\+waves (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{s,  }\item[{real(dp), intent(in)}]{k,  }\item[{real(dp), intent(in)}]{r,  }\item[{real(dp), dimension(\+:), intent(in)}]{lambdas,  }\item[{real(dp), dimension(\+:, \+:), intent(in)}]{d\+\_\+lambdas,  }\item[{real(dp), dimension(\+:), intent(inout)}]{tan\+\_\+deltas,  }\item[{real(dp), dimension(\+:, \+:), intent(inout)}]{d\+\_\+tan\+\_\+deltas }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Matches the uncoupled asymptotic solution the Coulomb wave function. 

When integrating the uncoupled variable phase equation in the pp channel, the wave function in the last integration step is matched form the free particle wave functions (reduced spherical Bessel functions) to the Coulomb wave functions.

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & spin quantum number\\
\hline
\mbox{\tt in}  & {\em k} & center of mass momentum (in units of fm $^{-1}$)\\
\hline
\mbox{\tt in}  & {\em r} & integration radius in fm\\
\hline
\mbox{\tt in}  & {\em lambdas} & lambda strength coefficients for all uncoupled waves in fm $^{-2}$\\
\hline
\mbox{\tt in}  & {\em d\+\_\+lambdas} & derivatives of lambda strength coefficients for all uncoupled waves\\
\hline
\mbox{\tt in,out}  & {\em tan\+\_\+deltas} & tangent of the phase shift for all uncoupled waves\\
\hline
\mbox{\tt in,out}  & {\em d\+\_\+tan\+\_\+deltas} & derivatives of the tangent of the phase shift for all uncoupled waves \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacenn__phaseshifts_a1d2c18032125ef6b75cc0170eb7c7cca}\label{namespacenn__phaseshifts_a1d2c18032125ef6b75cc0170eb7c7cca}} 
\index{nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}!momentum\+\_\+cm@{momentum\+\_\+cm}}
\index{momentum\+\_\+cm@{momentum\+\_\+cm}!nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}}
\subsubsection{\texorpdfstring{momentum\+\_\+cm()}{momentum\_cm()}}
{\footnotesize\ttfamily real(dp) function, public nn\+\_\+phaseshifts\+::momentum\+\_\+cm (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{t\+\_\+lab,  }\item[{character(len=2), intent(in)}]{reaction }\end{DoxyParamCaption})}



center of mass momentum 

Given the energy in the L\+AB frame and the type of reaction, calculates the center of mass momentum in units of fm $^{-1}$

\begin{DoxyReturn}{Returns}
center of mass in fm $^{-1}$
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em t\+\_\+lab} & Energy in L\+AB frame in MeV\\
\hline
\mbox{\tt in}  & {\em reaction} & Type of reaction. (pp, np or nn) \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacenn__phaseshifts_afbf7c7b1957246b291a52e9b125ef04e}\label{namespacenn__phaseshifts_afbf7c7b1957246b291a52e9b125ef04e}} 
\index{nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}!solve\+\_\+alfas@{solve\+\_\+alfas}}
\index{solve\+\_\+alfas@{solve\+\_\+alfas}!nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}}
\subsubsection{\texorpdfstring{solve\+\_\+alfas()}{solve\_alfas()}}
{\footnotesize\ttfamily subroutine nn\+\_\+phaseshifts\+::solve\+\_\+alfas (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{a1,  }\item[{real(dp), intent(in)}]{b1,  }\item[{real(dp), intent(in)}]{c1,  }\item[{real(dp), intent(in)}]{d1,  }\item[{real(dp), intent(in)}]{a2,  }\item[{real(dp), intent(in)}]{b2,  }\item[{real(dp), intent(in)}]{c2,  }\item[{real(dp), intent(in)}]{d2,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+a1,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+b1,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+c1,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+d1,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+a2,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+b2,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+c2,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+d2,  }\item[{real(dp), intent(out)}]{alfa\+\_\+1,  }\item[{real(dp), intent(out)}]{alfa\+\_\+2,  }\item[{real(dp), dimension(\+:), intent(out)}]{d\+\_\+alfa\+\_\+1,  }\item[{real(dp), dimension(\+:), intent(out)}]{d\+\_\+alfa\+\_\+2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



find alfa parameters in coupled channels 

After integrating the variable phase equation for coupled channels, solves a quadratic equation for the alpha parameters that determine the eigen phaseshifts.

See equation B25 in Phys. Rev. C 88 (2013) 064002

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a1} & the $A_1$ parameter\\
\hline
\mbox{\tt in}  & {\em b1} & the $B_1$ parameter\\
\hline
\mbox{\tt in}  & {\em c1} & the $C_1$ parameter\\
\hline
\mbox{\tt in}  & {\em d1} & the $D_1$ parameter\\
\hline
\mbox{\tt in}  & {\em a2} & the $A_2$ parameter\\
\hline
\mbox{\tt in}  & {\em b2} & the $B_2$ parameter\\
\hline
\mbox{\tt in}  & {\em c2} & the $C_2$ parameter\\
\hline
\mbox{\tt in}  & {\em d2} & the $D_2$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+a1} & derivatives of the $A_1$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+b1} & derivatives of the $B_1$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+c1} & derivatives of the $C_1$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+d1} & derivatives of the $D_1$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+a2} & derivatives of the $A_2$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+b2} & derivatives of the $B_2$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+c2} & derivatives of the $C_2$ parameter\\
\hline
\mbox{\tt in}  & {\em d\+\_\+d2} & derivatives of the $D_2$ parameter\\
\hline
\mbox{\tt out}  & {\em alfa\+\_\+1} & the $\alpha_1$ solution\\
\hline
\mbox{\tt out}  & {\em alfa\+\_\+2} & the $\alpha_2$ solution\\
\hline
\mbox{\tt out}  & {\em d\+\_\+alfa\+\_\+1} & derivatives of the $\alpha_1$ solution\\
\hline
\mbox{\tt out}  & {\em d\+\_\+alfa\+\_\+2} & derivatives of the $\alpha_2$ solution \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacenn__phaseshifts_a3af2de3d09433aeda72d9bf4f252ac9e}\label{namespacenn__phaseshifts_a3af2de3d09433aeda72d9bf4f252ac9e}} 
\index{nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}!uncoupled\+\_\+variable\+\_\+phase@{uncoupled\+\_\+variable\+\_\+phase}}
\index{uncoupled\+\_\+variable\+\_\+phase@{uncoupled\+\_\+variable\+\_\+phase}!nn\+\_\+phaseshifts@{nn\+\_\+phaseshifts}}
\subsubsection{\texorpdfstring{uncoupled\+\_\+variable\+\_\+phase()}{uncoupled\_variable\_phase()}}
{\footnotesize\ttfamily subroutine nn\+\_\+phaseshifts\+::uncoupled\+\_\+variable\+\_\+phase (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{l,  }\item[{real(dp), intent(in)}]{k,  }\item[{real(dp), intent(in)}]{r,  }\item[{real(dp), intent(in)}]{lambda,  }\item[{real(dp), dimension(\+:), intent(in)}]{d\+\_\+lambda,  }\item[{real(dp), intent(inout)}]{tan\+\_\+delta,  }\item[{real(dp), dimension(\+:), intent(inout)}]{d\+\_\+tan\+\_\+delta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



variable phase equation for uncoupled waves 

Performs a single step in the integration of the variable phase equation for uncoupled channels with a linear angular momentum l

See equation B14 in Phys. Rev. C 88 (2013) 064002

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em l} & orbital angular momentum quantum number\\
\hline
\mbox{\tt in}  & {\em k} & center of mass momentum (in units of fm $^{-1}$)\\
\hline
\mbox{\tt in}  & {\em r} & integration radius in fm\\
\hline
\mbox{\tt in}  & {\em lambda} & lambda strength coefficient in fm $^{-2}$\\
\hline
\mbox{\tt in}  & {\em d\+\_\+lambda} & derivatives of lambda with respect of model parameters\\
\hline
\mbox{\tt in,out}  & {\em tan\+\_\+delta} & tangent of the phase shift\\
\hline
\mbox{\tt in,out}  & {\em d\+\_\+tan\+\_\+delta} & derivatives of tan\+\_\+delta with respect of model parameters \\
\hline
\end{DoxyParams}
