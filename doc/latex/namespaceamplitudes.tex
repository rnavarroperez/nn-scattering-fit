\hypertarget{namespaceamplitudes}{}\section{amplitudes Module Reference}
\label{namespaceamplitudes}\index{amplitudes@{amplitudes}}
\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \hyperlink{interfaceamplitudes_1_1s__matrix__elements}{s\+\_\+matrix\+\_\+elements}
\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public \hyperlink{namespaceamplitudes_a2c13b08b9114f55d796fa0ad76fb1afd}{saclay\+\_\+amplitudes} (k\+\_\+cm, theta, reaction, phases, d\+\_\+phases, a, b, c, d, e, d\+\_\+a, d\+\_\+b, d\+\_\+c, d\+\_\+d, d\+\_\+e)
\begin{DoxyCompactList}\small\item\em calculate Saclay amplitudes \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespaceamplitudes_aca98c489bfb460150de74e01455194c6}{em\+\_\+pp\+\_\+amplitudes} (k\+\_\+cm, theta, a, b, c, d, e)
\item 
subroutine, public \hyperlink{namespaceamplitudes_a1ecc7462b112cd7709e06658b50bcf68}{em\+\_\+np\+\_\+amplitudes} (k\+\_\+cm, theta, a, b, c, d, e)
\item 
complex(dp) function \hyperlink{namespaceamplitudes_a15d06fdbb253231f6ba809a11be4bc0c}{f\+\_\+coulomb} (k\+\_\+cm, eta, theta)
\item 
complex(dp) function \hyperlink{namespaceamplitudes_a1deb8553133d2a765c200dddc6d4019e}{f\+\_\+coulomb2} (k\+\_\+cm, eta, theta)
\item 
complex(dp) function \hyperlink{namespaceamplitudes_aeefee706538ec9db13783ca6bf39139c}{f\+\_\+vacuum\+\_\+polarization} (k\+\_\+cm, eta, theta)
\item 
subroutine \hyperlink{namespaceamplitudes_a4c67568b324f005039a7a4a10fbfad32}{mm\+\_\+amplitudes} (k\+\_\+cm, eta, theta, m\+\_\+00, m\+\_\+11, m\+\_\+10, m\+\_\+01, m\+\_\+1m1)
\item 
subroutine \hyperlink{namespaceamplitudes_a3b59e51fa3e5cbeac091c86fa86b0005}{mm\+\_\+phases\+\_\+ls\+\_\+term} (k\+\_\+cm, mm\+\_\+phases)
\item 
subroutine \hyperlink{namespaceamplitudes_ac2fb8ddf880b4a5d9dd1d941ee9a9713}{m01\+\_\+ls\+\_\+contribution} (k\+\_\+cm, eta, theta, mm\+\_\+phases, m\+\_\+01)
\item 
subroutine \hyperlink{namespaceamplitudes_aefff90f83f922023f8bd5a617b88fcaa}{s\+\_\+matrix\+\_\+mm} (l\+\_\+prime, l, j, s, k\+\_\+cm, eta, reaction, phases, d\+\_\+phases, sm, d\+\_\+sm)
\item 
subroutine \hyperlink{namespaceamplitudes_ac9837614da738e17c9e58c87af369eef}{partial\+\_\+wave\+\_\+amplitude\+\_\+sum} (s\+\_\+mat, s, ms, mj, k\+\_\+cm, theta, reaction, phases, d\+\_\+phases, m, d\+\_\+m)
\begin{DoxyCompactList}\small\item\em sums over partial waves to calculate the amplitude \end{DoxyCompactList}\item 
real(dp) function \hyperlink{namespaceamplitudes_a6951abfeedd0051bf2e6de17ecc63192}{clebsch\+\_\+gordan} (l\+\_\+, s\+\_\+, j\+\_\+, ms\+\_\+, mj\+\_\+)
\begin{DoxyCompactList}\small\item\em Clebsch-\/\+Gordan coefficient. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespaceamplitudes_aa0bb740284302f942c6c9a699e5ca02e}{s\+\_\+matrix} (l\+\_\+prime, l, j, s, k\+\_\+cm, eta, reaction, phases, d\+\_\+phases, sm, d\+\_\+sm)
\begin{DoxyCompactList}\small\item\em S mastrix elements. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespaceamplitudes_a35c5cf6a646b74a95d965607bb5e9de1}{mm\+\_\+phaseshifts} (k\+\_\+cm, eta, mm\+\_\+phases)
\begin{DoxyCompactList}\small\item\em magnetic moment pp phase-\/shifts \end{DoxyCompactList}\item 
real(dp) function \hyperlink{namespaceamplitudes_abb9203b80454e518fb0b7083145bfcd8}{mm\+\_\+coulomb\+\_\+ill} (l, eta)
\begin{DoxyCompactList}\small\item\em $I_{l,l}$ term for mm phase-\/shifts \end{DoxyCompactList}\item 
real(dp) function \hyperlink{namespaceamplitudes_a36e09d619793ad91a1a65660cbf4ad7f}{mm\+\_\+coulomb\+\_\+illp2} (l, eta)
\begin{DoxyCompactList}\small\item\em $I_{l,l+2}$ term for mm phase-\/shifts \end{DoxyCompactList}\item 
real(dp) function \hyperlink{namespaceamplitudes_a6d36494ebd9aa3af10c1f7c40c80e876}{coulomb\+\_\+sigma\+\_\+l} (l, eta)
\begin{DoxyCompactList}\small\item\em Coulomb phase-\/shift. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
real(dp), parameter \hyperlink{namespaceamplitudes_a592f05bd4b5b0efc3ce15d946e8dd373}{f\+\_\+t} = -\/alpha$\ast$mu\+\_\+p$\ast$$\ast$2/(4$\ast$m\+\_\+p$\ast$$\ast$2)
\item 
real(dp), parameter \hyperlink{namespaceamplitudes_a66225c0cf7502883252939f6ab9b5b27}{f\+\_\+ls} = -\/alpha$\ast$(8$\ast$mu\+\_\+p -\/ 2)/(4$\ast$m\+\_\+p$\ast$$\ast$2)
\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespaceamplitudes_a6951abfeedd0051bf2e6de17ecc63192}\label{namespaceamplitudes_a6951abfeedd0051bf2e6de17ecc63192}} 
\index{amplitudes@{amplitudes}!clebsch\+\_\+gordan@{clebsch\+\_\+gordan}}
\index{clebsch\+\_\+gordan@{clebsch\+\_\+gordan}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{clebsch\+\_\+gordan()}{clebsch\_gordan()}}
{\footnotesize\ttfamily real(dp) function amplitudes\+::clebsch\+\_\+gordan (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{l\+\_\+,  }\item[{integer, intent(in)}]{s\+\_\+,  }\item[{integer, intent(in)}]{j\+\_\+,  }\item[{integer, intent(in)}]{ms\+\_\+,  }\item[{integer, intent(in)}]{mj\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Clebsch-\/\+Gordan coefficient. 

Calculates the Clebsch-\/\+Gordan coefficient $C_{ms,mj}^{l,s,j}$

\begin{DoxyReturn}{Returns}
Clebsch-\/\+Gordan coefficient $C_{ms,mj}^{l,s,j}$
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Rodrigo Navarro
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em l\+\_\+} & $l$ quantum number\\
\hline
\mbox{\tt in}  & {\em s\+\_\+} & $s$ quantum number\\
\hline
\mbox{\tt in}  & {\em j\+\_\+} & $j$ quantum number\\
\hline
\mbox{\tt in}  & {\em ms\+\_\+} & $m_s$ quantum number\\
\hline
\mbox{\tt in}  & {\em mj\+\_\+} & $m_j$ quantum number \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespaceamplitudes_a6d36494ebd9aa3af10c1f7c40c80e876}\label{namespaceamplitudes_a6d36494ebd9aa3af10c1f7c40c80e876}} 
\index{amplitudes@{amplitudes}!coulomb\+\_\+sigma\+\_\+l@{coulomb\+\_\+sigma\+\_\+l}}
\index{coulomb\+\_\+sigma\+\_\+l@{coulomb\+\_\+sigma\+\_\+l}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{coulomb\+\_\+sigma\+\_\+l()}{coulomb\_sigma\_l()}}
{\footnotesize\ttfamily real(dp) function amplitudes\+::coulomb\+\_\+sigma\+\_\+l (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{l,  }\item[{real(dp), intent(in)}]{eta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Coulomb phase-\/shift. 

Calculates the Coulomb phase-\/shift $\sigma_l $

The phase-\/shift is given by \[\sigma_l = {\rm arg} \Gamma(l+1+i\eta)\]

\begin{DoxyReturn}{Returns}
Coulomb phase-\/shift $\sigma_l$
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em l} & $l$ quantum number\\
\hline
\mbox{\tt in}  & {\em eta} & Sommerfeld parameter $\eta$ \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespaceamplitudes_a1ecc7462b112cd7709e06658b50bcf68}\label{namespaceamplitudes_a1ecc7462b112cd7709e06658b50bcf68}} 
\index{amplitudes@{amplitudes}!em\+\_\+np\+\_\+amplitudes@{em\+\_\+np\+\_\+amplitudes}}
\index{em\+\_\+np\+\_\+amplitudes@{em\+\_\+np\+\_\+amplitudes}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{em\+\_\+np\+\_\+amplitudes()}{em\_np\_amplitudes()}}
{\footnotesize\ttfamily subroutine, public amplitudes\+::em\+\_\+np\+\_\+amplitudes (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{k\+\_\+cm,  }\item[{real(dp), intent(in)}]{theta,  }\item[{complex(dp), intent(out)}]{a,  }\item[{complex(dp), intent(out)}]{b,  }\item[{complex(dp), intent(out)}]{c,  }\item[{complex(dp), intent(out)}]{d,  }\item[{complex(dp), intent(out)}]{e }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em k\+\_\+cm} & C.\+M. momentum in fm $^{-1}$\\
\hline
\mbox{\tt in}  & {\em theta} & scattering angle in radians\\
\hline
\mbox{\tt out}  & {\em a} & Sacalay parameter $a$\\
\hline
\mbox{\tt out}  & {\em b} & Sacalay parameter $b$\\
\hline
\mbox{\tt out}  & {\em c} & Sacalay parameter $c$\\
\hline
\mbox{\tt out}  & {\em d} & Sacalay parameter $d$\\
\hline
\mbox{\tt out}  & {\em e} & Sacalay parameter $e$ \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespaceamplitudes_aca98c489bfb460150de74e01455194c6}\label{namespaceamplitudes_aca98c489bfb460150de74e01455194c6}} 
\index{amplitudes@{amplitudes}!em\+\_\+pp\+\_\+amplitudes@{em\+\_\+pp\+\_\+amplitudes}}
\index{em\+\_\+pp\+\_\+amplitudes@{em\+\_\+pp\+\_\+amplitudes}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{em\+\_\+pp\+\_\+amplitudes()}{em\_pp\_amplitudes()}}
{\footnotesize\ttfamily subroutine, public amplitudes\+::em\+\_\+pp\+\_\+amplitudes (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{k\+\_\+cm,  }\item[{real(dp), intent(in)}]{theta,  }\item[{complex(dp), intent(out)}]{a,  }\item[{complex(dp), intent(out)}]{b,  }\item[{complex(dp), intent(out)}]{c,  }\item[{complex(dp), intent(out)}]{d,  }\item[{complex(dp), intent(out)}]{e }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em k\+\_\+cm} & C.\+M. momentum in fm $^{-1}$\\
\hline
\mbox{\tt in}  & {\em theta} & scattering angle in radians\\
\hline
\mbox{\tt out}  & {\em a} & Sacalay parameter $a$\\
\hline
\mbox{\tt out}  & {\em b} & Sacalay parameter $b$\\
\hline
\mbox{\tt out}  & {\em c} & Sacalay parameter $c$\\
\hline
\mbox{\tt out}  & {\em d} & Sacalay parameter $d$\\
\hline
\mbox{\tt out}  & {\em e} & Sacalay parameter $e$ \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespaceamplitudes_a15d06fdbb253231f6ba809a11be4bc0c}\label{namespaceamplitudes_a15d06fdbb253231f6ba809a11be4bc0c}} 
\index{amplitudes@{amplitudes}!f\+\_\+coulomb@{f\+\_\+coulomb}}
\index{f\+\_\+coulomb@{f\+\_\+coulomb}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{f\+\_\+coulomb()}{f\_coulomb()}}
{\footnotesize\ttfamily complex(dp) function amplitudes\+::f\+\_\+coulomb (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{k\+\_\+cm,  }\item[{real(dp), intent(in)}]{eta,  }\item[{real(dp), intent(in)}]{theta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{namespaceamplitudes_a1deb8553133d2a765c200dddc6d4019e}\label{namespaceamplitudes_a1deb8553133d2a765c200dddc6d4019e}} 
\index{amplitudes@{amplitudes}!f\+\_\+coulomb2@{f\+\_\+coulomb2}}
\index{f\+\_\+coulomb2@{f\+\_\+coulomb2}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{f\+\_\+coulomb2()}{f\_coulomb2()}}
{\footnotesize\ttfamily complex(dp) function amplitudes\+::f\+\_\+coulomb2 (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{k\+\_\+cm,  }\item[{real(dp), intent(in)}]{eta,  }\item[{real(dp), intent(in)}]{theta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{namespaceamplitudes_aeefee706538ec9db13783ca6bf39139c}\label{namespaceamplitudes_aeefee706538ec9db13783ca6bf39139c}} 
\index{amplitudes@{amplitudes}!f\+\_\+vacuum\+\_\+polarization@{f\+\_\+vacuum\+\_\+polarization}}
\index{f\+\_\+vacuum\+\_\+polarization@{f\+\_\+vacuum\+\_\+polarization}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{f\+\_\+vacuum\+\_\+polarization()}{f\_vacuum\_polarization()}}
{\footnotesize\ttfamily complex(dp) function amplitudes\+::f\+\_\+vacuum\+\_\+polarization (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{k\+\_\+cm,  }\item[{real(dp), intent(in)}]{eta,  }\item[{real(dp), intent(in)}]{theta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{namespaceamplitudes_ac2fb8ddf880b4a5d9dd1d941ee9a9713}\label{namespaceamplitudes_ac2fb8ddf880b4a5d9dd1d941ee9a9713}} 
\index{amplitudes@{amplitudes}!m01\+\_\+ls\+\_\+contribution@{m01\+\_\+ls\+\_\+contribution}}
\index{m01\+\_\+ls\+\_\+contribution@{m01\+\_\+ls\+\_\+contribution}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{m01\+\_\+ls\+\_\+contribution()}{m01\_ls\_contribution()}}
{\footnotesize\ttfamily subroutine amplitudes\+::m01\+\_\+ls\+\_\+contribution (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{k\+\_\+cm,  }\item[{real(dp), intent(in)}]{eta,  }\item[{real(dp), intent(in)}]{theta,  }\item[{real(dp), dimension(\+:, \+:), intent(in)}]{mm\+\_\+phases,  }\item[{complex(dp), intent(inout)}]{m\+\_\+01 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{namespaceamplitudes_a4c67568b324f005039a7a4a10fbfad32}\label{namespaceamplitudes_a4c67568b324f005039a7a4a10fbfad32}} 
\index{amplitudes@{amplitudes}!mm\+\_\+amplitudes@{mm\+\_\+amplitudes}}
\index{mm\+\_\+amplitudes@{mm\+\_\+amplitudes}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{mm\+\_\+amplitudes()}{mm\_amplitudes()}}
{\footnotesize\ttfamily subroutine amplitudes\+::mm\+\_\+amplitudes (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{k\+\_\+cm,  }\item[{real(dp), intent(in)}]{eta,  }\item[{real(dp), intent(in)}]{theta,  }\item[{complex(dp), intent(out)}]{m\+\_\+00,  }\item[{complex(dp), intent(out)}]{m\+\_\+11,  }\item[{complex(dp), intent(out)}]{m\+\_\+10,  }\item[{complex(dp), intent(out)}]{m\+\_\+01,  }\item[{complex(dp), intent(out)}]{m\+\_\+1m1 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{namespaceamplitudes_abb9203b80454e518fb0b7083145bfcd8}\label{namespaceamplitudes_abb9203b80454e518fb0b7083145bfcd8}} 
\index{amplitudes@{amplitudes}!mm\+\_\+coulomb\+\_\+ill@{mm\+\_\+coulomb\+\_\+ill}}
\index{mm\+\_\+coulomb\+\_\+ill@{mm\+\_\+coulomb\+\_\+ill}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{mm\+\_\+coulomb\+\_\+ill()}{mm\_coulomb\_ill()}}
{\footnotesize\ttfamily real(dp) function amplitudes\+::mm\+\_\+coulomb\+\_\+ill (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{l,  }\item[{real(dp), intent(in)}]{eta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



$I_{l,l}$ term for mm phase-\/shifts 

Calculates the $I_{l,l}$ term necessary for the calculation of the magnetic moment phases

The $I_{l,l}$ term results as an integral of the $1/r^3$ dependence on the magnetic moment potential and is given by

\[I_{l,l} = \frac{1}{2l(l+1)} + \frac{1-\pi \eta + \pi \eta \coth(\pi \eta)-2\eta^2\sum_{n=0}^l (n^2 + \eta^2)^{-1}} {2l(l+1)(2l+1)}\]

See Eq. 31 of Phys\+Rev\+C.\+88.\+064002 for more details.

\begin{DoxyReturn}{Returns}
$I_{l,l}$ term for mm phase-\/shifts
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em l} & $l$ quantum number\\
\hline
\mbox{\tt in}  & {\em eta} & Sommerfeld parameter $\eta$ \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespaceamplitudes_a36e09d619793ad91a1a65660cbf4ad7f}\label{namespaceamplitudes_a36e09d619793ad91a1a65660cbf4ad7f}} 
\index{amplitudes@{amplitudes}!mm\+\_\+coulomb\+\_\+illp2@{mm\+\_\+coulomb\+\_\+illp2}}
\index{mm\+\_\+coulomb\+\_\+illp2@{mm\+\_\+coulomb\+\_\+illp2}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{mm\+\_\+coulomb\+\_\+illp2()}{mm\_coulomb\_illp2()}}
{\footnotesize\ttfamily real(dp) function amplitudes\+::mm\+\_\+coulomb\+\_\+illp2 (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{l,  }\item[{real(dp), intent(in)}]{eta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



$I_{l,l+2}$ term for mm phase-\/shifts 

Calculates the $I_{l,l+2}$ term necessary for the calculation of the magnetic moment phases

The $I_{l,l+2}$ term results as an integral of the $1/r^3$ dependence on the magnetic moment potential and is given by

\[I_{l,l+2} = \frac{1}{6} |l+1+i\eta|^{-1} |l+2+i\eta|^{-1}\]

\begin{DoxyReturn}{Returns}
$I_{l,l+2}$ term for mm phase-\/shifts
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em l} & $l$ quantum number\\
\hline
\mbox{\tt in}  & {\em eta} & Sommerfeld parameter $\eta$ \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespaceamplitudes_a3b59e51fa3e5cbeac091c86fa86b0005}\label{namespaceamplitudes_a3b59e51fa3e5cbeac091c86fa86b0005}} 
\index{amplitudes@{amplitudes}!mm\+\_\+phases\+\_\+ls\+\_\+term@{mm\+\_\+phases\+\_\+ls\+\_\+term}}
\index{mm\+\_\+phases\+\_\+ls\+\_\+term@{mm\+\_\+phases\+\_\+ls\+\_\+term}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{mm\+\_\+phases\+\_\+ls\+\_\+term()}{mm\_phases\_ls\_term()}}
{\footnotesize\ttfamily subroutine amplitudes\+::mm\+\_\+phases\+\_\+ls\+\_\+term (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{k\+\_\+cm,  }\item[{real(dp), dimension(\+:, \+:), intent(out)}]{mm\+\_\+phases }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{namespaceamplitudes_a35c5cf6a646b74a95d965607bb5e9de1}\label{namespaceamplitudes_a35c5cf6a646b74a95d965607bb5e9de1}} 
\index{amplitudes@{amplitudes}!mm\+\_\+phaseshifts@{mm\+\_\+phaseshifts}}
\index{mm\+\_\+phaseshifts@{mm\+\_\+phaseshifts}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{mm\+\_\+phaseshifts()}{mm\_phaseshifts()}}
{\footnotesize\ttfamily subroutine amplitudes\+::mm\+\_\+phaseshifts (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{k\+\_\+cm,  }\item[{real(dp), intent(in)}]{eta,  }\item[{real(dp), dimension(\+:, \+:), intent(out)}]{mm\+\_\+phases }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



magnetic moment pp phase-\/shifts 

Calculates the partial-\/wave $K$ matrix elements for the magnetic moment pp amplitude

The $K$ matrix is defined as $S-1=2iK(1-iK)^{-1} $ where $S$ is the the scattering matrix determined by the pp magnetic moment potential.

See Eq. 29 in Phys\+Rev\+C.\+88.\+064002 for more details.

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em k\+\_\+cm} & C.\+M. momentum in $^{-1}$\\
\hline
\mbox{\tt in}  & {\em eta} & Sommerfeld parameter $\eta$\\
\hline
\mbox{\tt out}  & {\em mm\+\_\+phases} & magnetic momentum phase-\/shifts \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespaceamplitudes_ac9837614da738e17c9e58c87af369eef}\label{namespaceamplitudes_ac9837614da738e17c9e58c87af369eef}} 
\index{amplitudes@{amplitudes}!partial\+\_\+wave\+\_\+amplitude\+\_\+sum@{partial\+\_\+wave\+\_\+amplitude\+\_\+sum}}
\index{partial\+\_\+wave\+\_\+amplitude\+\_\+sum@{partial\+\_\+wave\+\_\+amplitude\+\_\+sum}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{partial\+\_\+wave\+\_\+amplitude\+\_\+sum()}{partial\_wave\_amplitude\_sum()}}
{\footnotesize\ttfamily subroutine amplitudes\+::partial\+\_\+wave\+\_\+amplitude\+\_\+sum (\begin{DoxyParamCaption}\item[{procedure(\hyperlink{interfaceamplitudes_1_1s__matrix__elements}{s\+\_\+matrix\+\_\+elements})}]{s\+\_\+mat,  }\item[{integer, intent(in)}]{s,  }\item[{integer, intent(in)}]{ms,  }\item[{integer, intent(in)}]{mj,  }\item[{real(dp), intent(in)}]{k\+\_\+cm,  }\item[{real(dp), intent(in)}]{theta,  }\item[{character(len=2), intent(in)}]{reaction,  }\item[{real(dp), dimension(\+:, \+:), intent(in)}]{phases,  }\item[{real(dp), dimension(\+:, \+:, \+:), intent(in), optional}]{d\+\_\+phases,  }\item[{complex(dp), intent(out)}]{m,  }\item[{complex(dp), dimension(\+:), intent(out), optional, allocatable}]{d\+\_\+m }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



sums over partial waves to calculate the amplitude 

Calculates a particular Wolfenstein parameter of the NN scattering amplitude determined by the set of quantum numbers $s$, $m_s$ and $m_s'$

The parameter is given by \[M_{m_s',m_s}^s(\theta) = \frac{1}{2ik} \sum_{J,l',l} \sqrt{4\pi(2l+1)} Y_{m_s'-m_s}^{l'}(\theta,0) C_{m_s-m_s',m_s',m_s}^{l',s,J} i^{l-l'} (S_{l,l'}^{J,s}-\delta_{l',l})C_{0,m_s,m_s}^{l,s,J},\]

where $Y_{m}^{l}(\theta,\varphi)$ are the spherical harmonics, $C_{m_l,m_s,m_j}^{l,s,j}$ are the Clebsch-\/\+Gordan coefficients and $S_{l,l'}^{j,s}$ are the scattering matrix elements (i.\+e. phase-\/shifts)

See equation 15 in Phys. Rev. C 91, 029901 (2015) for more details

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
 & {\em s\+\_\+mat} & S matrix elements (subroutine)\\
\hline
\mbox{\tt in}  & {\em s} & $s$ quantum number\\
\hline
\mbox{\tt in}  & {\em ms} & $m_s$ quantum number\\
\hline
\mbox{\tt in}  & {\em mj} & $m_j$ quantum number\\
\hline
\mbox{\tt in}  & {\em k\+\_\+cm} & C.\+M. momentum in fm $^{-1}$\\
\hline
\mbox{\tt in}  & {\em theta} & scattering angle in radians\\
\hline
\mbox{\tt in}  & {\em reaction} & reaction channel (pp or np)\\
\hline
\mbox{\tt in}  & {\em phases} & corresponding phase-\/shifts\\
\hline
\mbox{\tt in}  & {\em d\+\_\+phases} & derivatives of the phase-\/shifts\\
\hline
\mbox{\tt out}  & {\em m} & Wolfenstein parameter\\
\hline
\mbox{\tt out}  & {\em d\+\_\+m} & derivatives of the Wolfenstein parameter \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespaceamplitudes_aa0bb740284302f942c6c9a699e5ca02e}\label{namespaceamplitudes_aa0bb740284302f942c6c9a699e5ca02e}} 
\index{amplitudes@{amplitudes}!s\+\_\+matrix@{s\+\_\+matrix}}
\index{s\+\_\+matrix@{s\+\_\+matrix}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{s\+\_\+matrix()}{s\_matrix()}}
{\footnotesize\ttfamily subroutine amplitudes\+::s\+\_\+matrix (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{l\+\_\+prime,  }\item[{integer, intent(in)}]{l,  }\item[{integer, intent(in)}]{j,  }\item[{integer, intent(in)}]{s,  }\item[{real(dp), intent(in)}]{k\+\_\+cm,  }\item[{real(dp), intent(in)}]{eta,  }\item[{character(len=2), intent(in)}]{reaction,  }\item[{real(dp), dimension(\+:,\+:), intent(in)}]{phases,  }\item[{real(dp), dimension(\+:, \+:, \+:), intent(in), optional}]{d\+\_\+phases,  }\item[{complex(dp), intent(out)}]{sm,  }\item[{complex(dp), dimension(\+:), intent(out), optional, allocatable}]{d\+\_\+sm }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



S mastrix elements. 

Given a set of quantum number $l'$, $l$, $j$, $s$ extracts the corresponding element from the NN scattering matrix $S - \detla_{l, l'}$

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em l\+\_\+prime} & $l'$ quantum number\\
\hline
\mbox{\tt in}  & {\em l} & $l$ quantum number\\
\hline
\mbox{\tt in}  & {\em j} & $j$ quantum number\\
\hline
\mbox{\tt in}  & {\em s} & $s$ quantum number\\
\hline
\mbox{\tt in}  & {\em k\+\_\+cm} & C.\+M. momentum in $^{-1}$\\
\hline
\mbox{\tt in}  & {\em eta} & Sommerfeld parameter $\eta'$\\
\hline
\mbox{\tt in}  & {\em reaction} & reaction channel (pp or np)\\
\hline
\mbox{\tt in}  & {\em phases} & corresponding phase-\/shifts\\
\hline
\mbox{\tt in}  & {\em d\+\_\+phases} & derivatives of the phase-\/shifts\\
\hline
\mbox{\tt out}  & {\em sm} & matrix element\\
\hline
\mbox{\tt out}  & {\em d\+\_\+sm} & derivatives of matrix element \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespaceamplitudes_aefff90f83f922023f8bd5a617b88fcaa}\label{namespaceamplitudes_aefff90f83f922023f8bd5a617b88fcaa}} 
\index{amplitudes@{amplitudes}!s\+\_\+matrix\+\_\+mm@{s\+\_\+matrix\+\_\+mm}}
\index{s\+\_\+matrix\+\_\+mm@{s\+\_\+matrix\+\_\+mm}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{s\+\_\+matrix\+\_\+mm()}{s\_matrix\_mm()}}
{\footnotesize\ttfamily subroutine amplitudes\+::s\+\_\+matrix\+\_\+mm (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{l\+\_\+prime,  }\item[{integer, intent(in)}]{l,  }\item[{integer, intent(in)}]{j,  }\item[{integer, intent(in)}]{s,  }\item[{real(dp), intent(in)}]{k\+\_\+cm,  }\item[{real(dp), intent(in)}]{eta,  }\item[{character(len=2), intent(in)}]{reaction,  }\item[{real(dp), dimension(\+:,\+:), intent(in)}]{phases,  }\item[{real(dp), dimension(\+:, \+:, \+:), intent(in), optional}]{d\+\_\+phases,  }\item[{complex(dp), intent(out)}]{sm,  }\item[{complex(dp), dimension(\+:), intent(out), optional, allocatable}]{d\+\_\+sm }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em l\+\_\+prime} & $l'$ quantum number\\
\hline
\mbox{\tt in}  & {\em l} & $l$ quantum number\\
\hline
\mbox{\tt in}  & {\em j} & $j$ quantum number\\
\hline
\mbox{\tt in}  & {\em s} & $s$ quantum number\\
\hline
\mbox{\tt in}  & {\em k\+\_\+cm} & C.\+M. momentum in $^{-1}$\\
\hline
\mbox{\tt in}  & {\em eta} & Sommerfeld parameter $\eta'$\\
\hline
\mbox{\tt in}  & {\em reaction} & reaction channel (pp or np)\\
\hline
\mbox{\tt in}  & {\em phases} & corresponding phase-\/shifts\\
\hline
\mbox{\tt in}  & {\em d\+\_\+phases} & derivatives of the phase-\/shifts\\
\hline
\mbox{\tt out}  & {\em sm} & matrix element\\
\hline
\mbox{\tt out}  & {\em d\+\_\+sm} & derivatives of matrix element \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespaceamplitudes_a2c13b08b9114f55d796fa0ad76fb1afd}\label{namespaceamplitudes_a2c13b08b9114f55d796fa0ad76fb1afd}} 
\index{amplitudes@{amplitudes}!saclay\+\_\+amplitudes@{saclay\+\_\+amplitudes}}
\index{saclay\+\_\+amplitudes@{saclay\+\_\+amplitudes}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{saclay\+\_\+amplitudes()}{saclay\_amplitudes()}}
{\footnotesize\ttfamily subroutine, public amplitudes\+::saclay\+\_\+amplitudes (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{k\+\_\+cm,  }\item[{real(dp), intent(in)}]{theta,  }\item[{character(len=2), intent(in)}]{reaction,  }\item[{real(dp), dimension(\+:, \+:), intent(in)}]{phases,  }\item[{real(dp), dimension(\+:, \+:, \+:), intent(in)}]{d\+\_\+phases,  }\item[{complex(dp), intent(out)}]{a,  }\item[{complex(dp), intent(out)}]{b,  }\item[{complex(dp), intent(out)}]{c,  }\item[{complex(dp), intent(out)}]{d,  }\item[{complex(dp), intent(out)}]{e,  }\item[{complex(dp), dimension(\+:), intent(out), allocatable}]{d\+\_\+a,  }\item[{complex(dp), dimension(\+:), intent(out), allocatable}]{d\+\_\+b,  }\item[{complex(dp), dimension(\+:), intent(out), allocatable}]{d\+\_\+c,  }\item[{complex(dp), dimension(\+:), intent(out), allocatable}]{d\+\_\+d,  }\item[{complex(dp), dimension(\+:), intent(out), allocatable}]{d\+\_\+e }\end{DoxyParamCaption})}



calculate Saclay amplitudes 

Calculates the NN scattering amplitude in the Saclay parametrization for a given c.\+m. momentum, scattering angle, reaction channel and the corresponding phase-\/shifts.

\begin{DoxyAuthor}{Author}
Rodrigo Navarro Perez
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em k\+\_\+cm} & C.\+M. momentum in fm $^{-1}$\\
\hline
\mbox{\tt in}  & {\em theta} & scattering angle in radians\\
\hline
\mbox{\tt in}  & {\em reaction} & reaction channel (pp or np)\\
\hline
\mbox{\tt in}  & {\em phases} & corresponding phase-\/shifts\\
\hline
\mbox{\tt in}  & {\em d\+\_\+phases} & derivatives of the phase-\/shifts\\
\hline
\mbox{\tt out}  & {\em a} & Sacalay parameter $a$\\
\hline
\mbox{\tt out}  & {\em b} & Sacalay parameter $b$\\
\hline
\mbox{\tt out}  & {\em c} & Sacalay parameter $c$\\
\hline
\mbox{\tt out}  & {\em d} & Sacalay parameter $d$\\
\hline
\mbox{\tt out}  & {\em e} & Sacalay parameter $e$\\
\hline
\mbox{\tt out}  & {\em d\+\_\+a} & derivatives of the Sacalay parameter $a$\\
\hline
\mbox{\tt out}  & {\em d\+\_\+b} & derivatives of the Sacalay parameter $b$\\
\hline
\mbox{\tt out}  & {\em d\+\_\+c} & derivatives of the Sacalay parameter $c$\\
\hline
\mbox{\tt out}  & {\em d\+\_\+d} & derivatives of the Sacalay parameter $d$\\
\hline
\mbox{\tt out}  & {\em d\+\_\+e} & derivatives of the Sacalay parameter $e$ \\
\hline
\end{DoxyParams}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespaceamplitudes_a66225c0cf7502883252939f6ab9b5b27}\label{namespaceamplitudes_a66225c0cf7502883252939f6ab9b5b27}} 
\index{amplitudes@{amplitudes}!f\+\_\+ls@{f\+\_\+ls}}
\index{f\+\_\+ls@{f\+\_\+ls}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{f\+\_\+ls}{f\_ls}}
{\footnotesize\ttfamily real(dp), parameter amplitudes\+::f\+\_\+ls = -\/alpha$\ast$(8$\ast$mu\+\_\+p -\/ 2)/(4$\ast$m\+\_\+p$\ast$$\ast$2)}

\mbox{\Hypertarget{namespaceamplitudes_a592f05bd4b5b0efc3ce15d946e8dd373}\label{namespaceamplitudes_a592f05bd4b5b0efc3ce15d946e8dd373}} 
\index{amplitudes@{amplitudes}!f\+\_\+t@{f\+\_\+t}}
\index{f\+\_\+t@{f\+\_\+t}!amplitudes@{amplitudes}}
\subsubsection{\texorpdfstring{f\+\_\+t}{f\_t}}
{\footnotesize\ttfamily real(dp), parameter amplitudes\+::f\+\_\+t = -\/alpha$\ast$mu\+\_\+p$\ast$$\ast$2/(4$\ast$m\+\_\+p$\ast$$\ast$2)}

